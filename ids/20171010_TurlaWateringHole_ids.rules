alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"401TRG - Possible Turla APT SWC Redirect - Clicky Campaign M1"; flow:established,from_server; file_data; content:"clicky_site_ids"; fast_pattern; content:"document.createElement"; nocase; distance:0; within:100; content:"/counter.js"; distance:0; content:"text/javascript"; distance:0; content:".appendChild"; distance:0; content:"|3b|"; pcre:"/^\s*[^\r\n]+\.\s*src\s*=\s*[\x22\x27]\s*[a-z]+\.getclicky\.com\/js\s*[\x22\x27]\s*\x3b/Rsi"; reference:url,https://401trg.pw/turla-watering-hole-campaigns-2016-2017/; sid:70045804; rev:1;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"401TRG - Possible Turla APT SWC Redirect - Clicky Campaign M2"; flow:established,from_server; file_data; content:"document.createElement"; nocase; fast_pattern; content:"var"; distance:0; within:50; content:"text/javascript"; distance:0; content:".appendChild"; distance:0; content:"var"; pcre:"/^\s*(?P<vara>[A-Za-z0-9-_]{1,20})\s*=\s*[\x22\x27]\s*http\x3a\x2f\x2f[^\r\n]+[\x22\x27]\s*\x3b\s*var\s*(?P<varb>[A-Za-z0-9-_]{1,20})\s*=\s*[\x22\x27]\s*\/[^\r\n]+[\x22\x27]\s*\x3b\s*.+\.\s*src\s*=\s*(?P=vara)\s*\.\s*concat\s*\(\s*(?P=varb)\s*\)\s*\x3b/Rsi"; reference:url,https://401trg.pw/turla-watering-hole-campaigns-2016-2017/; sid:70045805; rev:1;)
